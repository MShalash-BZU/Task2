<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Local Users Table</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <h1>Users Table (Local Data)</h1>

      <div class="controls">
        <label>
          <span class="label">Search:</span>
          <input
            id="search"
            type="search"
            placeholder="Search name, email, or company..."
          />
        </label>

        <label>
          <span class="label">Per page:</span>
          <select id="perPage">
            <option>5</option>
            <option selected>10</option>
            <option>20</option>
          </select>
        </label>
      </div>

      <div id="status"></div>

      <div class="table-wrap">
        <table id="table">
          <thead>
            <tr>
              <th data-key="id">ID</th>
              <th data-key="name">Name</th>
              <th data-key="email">Email</th>
              <th data-key="company">Company</th>
              <th data-key="city">City</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="pager">
        <button id="prev">Previous</button>
        <span id="pageInfo"></span>
        <button id="next">Next</button>
      </div>
    </div>

    <script>
      const users = [
        {
          id: 1,
          name: "Leanne Graham",
          email: "leanne@example.com",
          company: "Romaguera-Crona",
          city: "Gwenborough",
        },
        {
          id: 2,
          name: "Ervin Howell",
          email: "ervin@example.com",
          company: "Deckow-Crist",
          city: "Wisokyburgh",
        },
        {
          id: 3,
          name: "Clementine Bauch",
          email: "clementine@example.com",
          company: "Romaguera-Jacobson",
          city: "McKenziehaven",
        },
        {
          id: 4,
          name: "Patricia Lebsack",
          email: "patricia@example.com",
          company: "Robel-Corkery",
          city: "South Elvis",
        },
        {
          id: 5,
          name: "Chelsey Dietrich",
          email: "chelsey@example.com",
          company: "Keebler LLC",
          city: "Roscoeview",
        },
        {
          id: 6,
          name: "Mrs. Dennis Schulist",
          email: "dennis@example.com",
          company: "Considine-Lockman",
          city: "South Christy",
        },
        {
          id: 7,
          name: "Kurtis Weissnat",
          email: "kurtis@example.com",
          company: "Johns Group",
          city: "Howemouth",
        },
        {
          id: 8,
          name: "Nicholas Runolfsdottir",
          email: "nick@example.com",
          company: "Abernathy Group",
          city: "Aliyaview",
        },
        {
          id: 9,
          name: "Glenna Reichert",
          email: "glenna@example.com",
          company: "Yost and Sons",
          city: "Bartholomebury",
        },
        {
          id: 10,
          name: "Clementina DuBuque",
          email: "clementina@example.com",
          company: "Hoeger LLC",
          city: "Lebsackbury",
        },
        {
          id: 11,
          name: "Sameera Abbas",
          email: "sameera@example.com",
          company: "AI Labs",
          city: "Birzeit",
        },
      ];

      const tbody = document.querySelector("#table tbody");
      const searchInput = document.getElementById("search");
      const perPageSelect = document.getElementById("perPage");
      const prevBtn = document.getElementById("prev");
      const nextBtn = document.getElementById("next");
      const pageInfo = document.getElementById("pageInfo");

      let filtered = [...users];
      let page = 1;
      let perPage = Number(perPageSelect.value);

      function render() {
        const total = filtered.length;
        const totalPages = Math.ceil(total / perPage) || 1;
        if (page > totalPages) page = totalPages;
        const start = (page - 1) * perPage;
        const visible = filtered.slice(start, start + perPage);

        tbody.innerHTML = visible
          .map(
            (u) => `
        <tr>
          <td>${u.id}</td>
          <td>${u.name}</td>
          <td>${u.email}</td>
          <td>${u.company}</td>
          <td>${u.city}</td>
        </tr>`
          )
          .join("");

        pageInfo.textContent = `Page ${page} of ${totalPages} (${total} total)`;
        prevBtn.disabled = page === 1;
        nextBtn.disabled = page === totalPages;
      }

      function applyFilter() {
        const q = searchInput.value.trim().toLowerCase();
        filtered = users.filter(
          (u) =>
            u.name.toLowerCase().includes(q) ||
            u.email.toLowerCase().includes(q) ||
            u.company.toLowerCase().includes(q) ||
            u.city.toLowerCase().includes(q)
        );
        page = 1;
        render();
      }

      searchInput.addEventListener("input", applyFilter);
      perPageSelect.addEventListener("change", () => {
        perPage = Number(perPageSelect.value);
        render();
      });

      prevBtn.addEventListener("click", () => {
        if (page > 1) {
          page--;
          render();
        }
      });
      nextBtn.addEventListener("click", () => {
        const totalPages = Math.ceil(filtered.length / perPage);
        if (page < totalPages) {
          page++;
          render();
        }
      });

      render();
    </script>
  </body>
</html>
